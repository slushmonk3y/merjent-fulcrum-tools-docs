<!-- start:source.tmpl.hbs -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
		<title>Mtools/RequestHelpers.js</title>
		<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<link href="https://fonts.googleapis.com/css?family=PT+Mono" rel="stylesheet">
		<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="css/prism.min.css">
		<link type="text/css" rel="stylesheet" href="css/template.min.css">
		<script type="text/javascript">
			window.TEMPLATE_OPTIONS = {"includeDate":true,"dateFormat":"Do MMM YYYY","systemName":"Merjent Fulcrum Tools","systemSummary":"Modules for modifying Fulcrum apps","systemLogo":"","systemColor":"","navMembers":[{"kind":"module","title":"Modules","summary":"All documented modules."},{"kind":"class","title":"Classes","summary":"All documented classes."},{"kind":"external","title":"Externals","summary":"All documented external members."},{"kind":"global","title":"Globals","summary":"All documented globals."},{"kind":"mixin","title":"Mixins","summary":"All documented mixins."},{"kind":"interface","title":"Interfaces","summary":"All documented interfaces."},{"kind":"namespace","title":"Namespaces","summary":"All documented namespaces."},{"kind":"tutorial","title":"Tutorials","summary":"All available tutorials."}],"footer":"","copyright":" ","linenums":true,"collapseSymbols":true,"inverseNav":true,"inlineNav":false,"outputSourceFiles":false,"sourceRootPath":null,"disablePackagePath":true,"outputSourcePath":false,"showTableOfContents":true,"showAccessFilter":true,"analytics":null,"methodHeadingReturns":true,"sort":"longname","search":true,"favicon":null,"stylesheets":[],"scripts":[],"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":false}};
			window.DOCLET_TOC_ENABLED = false;
			window.DOCLET_AFILTER_ENABLED = false;
		</script>
</head>
<body>
	<!-- start:navbar.hbs -->
	<header class="navbar navbar-default navbar-fixed-top navbar-inverse">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand" href="index.html">
					Merjent Fulcrum Tools
				</a>
				<!-- displayed on small devices -->
				<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>
			<div class="navbar-collapse collapse" id="topNavigation">
				<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="list_class.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="DataEventHelpers.html">DataEventHelpers</a></li>
											<li><a href="FieldHelpers.html">FieldHelpers</a></li>
											<li><a href="FulcrumHelpers.html">FulcrumHelpers</a></li>
											<li><a href="Helpers.html">Helpers</a></li>
											<li><a href="MerjentApp.html">MerjentApp</a></li>
											<li><a href="ReportHelpers.html">ReportHelpers</a></li>
											<li><a href="RequestHelpers.html">RequestHelpers</a></li>
									</ul>
								</li>
								<li class="dropdown">
									<a href="list_module.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="module-dataEventMtools.html">dataEventMtools</a></li>
											<li><a href="module-merjentAppModule.html">merjentAppModule</a></li>
											<li><a href="module-reportMtools.html">reportMtools</a></li>
									</ul>
								</li>
								<li class="dropdown">
									<a href="list_namespace.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="MerjentApp.AppTemplates.html">MerjentApp.AppTemplates</a></li>
											<li><a href="MerjentApp.DefaultMethods.html">MerjentApp.DefaultMethods</a></li>
											<li><a href="MerjentApp.PermissionMethods.html">MerjentApp.PermissionMethods</a></li>
											<li><a href="MerjentApp.StatusMethods.html">MerjentApp.StatusMethods</a></li>
									</ul>
								</li>
								<li class="dropdown">
									<a href="list_tutorial.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="MerjentApp.html">MerjentApp</a></li>
											<li><a href="tutorial-Utils.html">Utils</a></li>
									</ul>
								</li>
				</ul>
					<!-- start:lunr-search-navbar.hbs -->
					<form class="navbar-form navbar-right" role="search">
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Search" id="lunr-search-input">
							<div class="input-group-btn">
								<button class="btn btn-default" id="lunr-search-submit">
									<i class="glyphicon glyphicon-search"></i>
								</button>
							</div>
						</div>
					</form>
					<!-- start:lunr-search-navbar.hbs -->		</div>
		</div>
	</header>
	<!-- end:navbar.hbs -->		<div class="page-header">
			<div class="container">
				<span class="kind">source</span>
				<h1><span class="name">Mtools/RequestHelpers.js</span></h1>
			</div>
		</div>
	<div class="container content">
		<div class="row">
			<div class="col-md-12 main-content">
		<section class="source-section">
			<article></article>
			<pre class="prettyprint source language-javascript line-numbers"><code class="language-javascript">import { Helpers,FulcrumHelpers,MLoadRecs } from "./FulcrumHelpers";

//#region ******************************** REQUEST HELPERS ***********************************/
/**
 * @description Description placeholder
 */
class RequestHelpers extends FulcrumHelpers {
  constructor(){super()}
  /**
   * @description Description placeholder
   *
   * @param {*} error 
   */
  checkConnection(error){
    var first = error.message.slice(0,22)
    var match = 'Unable to resolve host'
    if (first != match){
      ALERT('Unable to complete task without data connection');
    }
    if (first != match){
      ALERT('Error with request: ' + INSPECT(error));
    }
  };
  
  /**
   * @description Description placeholder
   *
   * @param {string} query
   * @param {Function} [callback]
   * @param {*} [opt=null] 
   * @returns {*}
   */
  requestAppRecords(query, callback, opt = null) {
    // var url = 'https://api.fulcrumapp.com/api/v2/query?format=json&amp;q=' + encodeURIComponent(query) + '&amp;token=' + mToken
    var url = 'https://api.fulcrumapp.com/api/v2/query/';
    var options = {
      url: url,
      method: 'GET',
      contentType: 'application/json',
      headers: { 'X-ApiToken': mToken },
      qs: { 'format': 'json', 'q': query }
    };
    REQUEST(options, function (error, response, body) {
      if (error) {
        ALERT('Error with request: ' + INSPECT(error));
      } else {
        if (body) {
          var jrecords = JSON.parse(body).rows;
          if (callback &amp;&amp; jrecords) {
            callback(jrecords, opt);
          }
          return jrecords
          // SETTIMEOUT(function() {
          //   enterFunc(jrecords);
          // }, 3000);
        }
      }
    });
  };

  /**
   * @description Description placeholder
   *
   * @param {string} appId - fulcrum app id
   * @param {string} [qflds=''] - fields to pull in request
   * @param {string[]} recIDs - array or _record_id to request
   * @param {Function} callback - callback
   * @param {*} [opt=null] - option for callback
   * @returns {*}
   * @example
   * function enterDisturbanceAreaTypeCallback(rows,dn){
   *    var output = rows.map(x => x.disturbance_area_type)
   *    SETVALUE(dn,output.join(', '))
   * }
   * 
   * var opt = 'disturbance_area_types'
   * 
   * M.requestRecById(appId,qflds,recIDs,enterDisturbanceAreaTypeCallback,opt)
   */
  requestRecById(appId, qflds = '', recIDs, callback, opt=null) {
    var query = `SELECT _record_id, _status${qflds} FROM "${appId}" WHERE _record_id = ANY('{${recIDs.join(',')}}');`;
    this.requestAppRecords(query, callback, opt);
  };

   /**
   * @description Description placeholder
   *
   * @param {Array.&lt;{_record_id : string }>} - rows
   * @param {*} opt - data name of field to enter record links into
   * @returns {*}
   */
  enterLinks(rows, opt) {
    var links = rows.map(x => x._record_id);
    SETVALUE(opt, links);
  };

  /**
   * @description Description placeholder
   *
   * @param {string} recID - _record_id to get
   * @param {*} record
   * @param {Function} callback - callback to modify properties of existing record
   * @param {number} [index] - index of current record. If being called from array.
   * @param {number} [end] - index of last record in array of records. If being called from array.
   * @param {string} [complete=''] - Text for alert message when this.updateRecord is complete
   * @returns {*}
   */
  updateRecord(recID, record, callback, index, end, complete = '') {
    var newRecord = callback(record) || null;
    var isComplete = index == end ? true : false;
    
    if (newRecord) {
      var url = 'https://api.fulcrumapp.com/api/v2/records/' + recID + '.json?';
      var options = {
        url: url,
        method: 'PUT',
        //contentType: 'application/json',
        headers: {
          'X-ApiToken': mToken,
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify(newRecord)
      };
      REQUEST(options, function (error, response, body) {
        if (error) {
          ALERT('Error with request: ' + INSPECT(error));
        } else {
          if (isComplete) {
            ALERT(complete);
            return
          }
        }
      });
    }
  };

  /**
   * @description Description placeholder
   *
   * @param {string} recID - _record_id to get
   * @param {Function} [callback] - callback is used by M.updateRecord
   * @param {number} [index] - index of current record. If being called from array.
   * @param {number} [end] - index of last record in array of records. If being called from array.
   * @param {string} [complete=''] - Text for alert message when this.updateRecord is complete
   * @returns {*}
   */
  getRecord(recID = '', callback, index, end, complete = '',ur=this.updateRecord) {
    var url = 'https://api.fulcrumapp.com/api/v2/records/' + recID + '.json?';
    var options = {
      url: url,
      method: 'GET',
      headers: {
        'X-ApiToken': mToken,
      }
    };
    REQUEST(options, function (error, response, body) {
      if (error) {
        ALERT('Error with request: ' + INSPECT(error));
      } else {
        var record = JSON.parse(body) ? JSON.parse(body) : null;
        if (!callback) {
          return record;
        }
        if (callback &amp;&amp; record) {
          ur(recID, record, callback, index, end, complete);
        } 
      }
    });
  };


}
//#endregion

export { Helpers,FulcrumHelpers,MLoadRecs,RequestHelpers }</code></pre>
		</section>
			</div>
		</div>
	</div>
	<footer>
				<div class="copyright"> </div>
			<div class="generated-by">Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on 15th Sep 2025 using the <a href="https://github.com/steveush/foodoc">FooDoc template</a>.</div>
	</footer>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/clipboard.min.js"></script>
	<script src="js/prism.min.js"></script>
	<script src="js/template.min.js"></script>
		<!-- start:lunr-search-modal.hbs -->
		<div class="modal fade" id="lunr-search-modal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title">Search results</h4>
					</div>
					<div class="modal-body" id="lunr-search-body">
					</div>
					<div class="modal-footer" id="lunr-search-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div>
		<!-- end:lunr-search-modal.hbs -->		<script src="js/lunr.min.js"></script>
	
</body>
</html>
<!-- end:source.tmpl.hbs -->