<!-- start:source.tmpl.hbs -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
		<title>Mtools/Helpers.js</title>
		<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<link href="https://fonts.googleapis.com/css?family=PT+Mono" rel="stylesheet">
		<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="css/prism.min.css">
		<link type="text/css" rel="stylesheet" href="css/template.min.css">
		<script type="text/javascript">
			window.TEMPLATE_OPTIONS = {"includeDate":true,"dateFormat":"Do MMM YYYY","systemName":"Merjent Fulcrum Tools","systemSummary":"Modules for common tasks in Merjent Fulcrum apps","systemLogo":"","systemColor":"","navMembers":[{"kind":"module","title":"Modules","summary":"All documented modules."},{"kind":"class","title":"Classes","summary":"All documented classes."},{"kind":"external","title":"Externals","summary":"All documented external members."},{"kind":"global","title":"Globals","summary":"All documented globals."},{"kind":"mixin","title":"Mixins","summary":"All documented mixins."},{"kind":"interface","title":"Interfaces","summary":"All documented interfaces."},{"kind":"namespace","title":"Namespaces","summary":"All documented namespaces."},{"kind":"tutorial","title":"Tutorials","summary":"All available tutorials."}],"footer":"","copyright":"Mtools Copyright Â© 2025 Mikel Paiva","linenums":true,"collapseSymbols":true,"inverseNav":true,"inlineNav":false,"outputSourceFiles":false,"sourceRootPath":null,"disablePackagePath":true,"outputSourcePath":false,"showTableOfContents":false,"showAccessFilter":true,"analytics":null,"methodHeadingReturns":true,"sort":"longname","search":true,"favicon":null,"stylesheets":[],"scripts":[],"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":false}};
			window.DOCLET_TOC_ENABLED = false;
			window.DOCLET_AFILTER_ENABLED = false;
		</script>
</head>
<body>
	<!-- start:navbar.hbs -->
	<header class="navbar navbar-default navbar-fixed-top navbar-inverse">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand" href="index.html">
					Merjent Fulcrum Tools
				</a>
				<!-- displayed on small devices -->
				<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>
			<div class="navbar-collapse collapse" id="topNavigation">
				<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="list_class.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="DataEventHelpers.html">DataEventHelpers</a></li>
											<li><a href="FieldHelpers.html">FieldHelpers</a></li>
											<li><a href="FulcrumHelpers.html">FulcrumHelpers</a></li>
											<li><a href="Helpers.html">Helpers</a></li>
											<li><a href="MerjentApp.html">MerjentApp</a></li>
											<li><a href="ReportHelpers.html">ReportHelpers</a></li>
											<li><a href="RequestHelpers.html">RequestHelpers</a></li>
									</ul>
								</li>
								<li class="dropdown">
									<a href="list_module.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="module-dataEventMtools.html">dataEventMtools</a></li>
											<li><a href="module-merjentAppModule.html">merjentAppModule</a></li>
											<li><a href="module-reportMtools.html">reportMtools</a></li>
									</ul>
								</li>
								<li class="dropdown">
									<a href="list_namespace.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="MerjentApp.AppTemplates.html">MerjentApp.AppTemplates</a></li>
											<li><a href="MerjentApp.DefaultMethods.html">MerjentApp.DefaultMethods</a></li>
											<li><a href="MerjentApp.PermissionMethods.html">MerjentApp.PermissionMethods</a></li>
											<li><a href="MerjentApp.StatusMethods.html">MerjentApp.StatusMethods</a></li>
									</ul>
								</li>
								<li class="dropdown">
									<a href="list_tutorial.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
									<ul class="dropdown-menu">
											<li><a href="tutorial-CHANGELOG.html">CHANGELOG</a></li>
											<li><a href="tutorial-Other.html">Other Development Information</a></li>
											<li><a href="tutorial-Overview.html">Overview</a></li>
									</ul>
								</li>
				</ul>
					<!-- start:lunr-search-navbar.hbs -->
					<form class="navbar-form navbar-right" role="search">
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Search" id="lunr-search-input">
							<div class="input-group-btn">
								<button class="btn btn-default" id="lunr-search-submit">
									<i class="glyphicon glyphicon-search"></i>
								</button>
							</div>
						</div>
					</form>
					<!-- start:lunr-search-navbar.hbs -->		</div>
		</div>
	</header>
	<!-- end:navbar.hbs -->		<div class="page-header">
			<div class="container">
				<span class="kind">source</span>
				<h1><span class="name">Mtools/Helpers.js</span></h1>
			</div>
		</div>
	<div class="container content">
		<div class="row">
			<div class="col-md-12 main-content">
		<section class="source-section">
			<article></article>
			<pre class="prettyprint source language-javascript line-numbers"><code class="language-javascript">//#region ********************************** HELPERS *****************************************/
/**
 * @summary Utility helper methods
 * @description For use in any JavaScript project, including Google Apps scripts etc.  
 */
class Helpers {
  constructor(){ }

  formatVal(val, naVal = null){ return this.fVal(val, naVal = null) }

  /**
   * @summary Checks if object is an instance of a specific class. 
   * @description Wrapper for instanceof operator.
   * @param {} obj - Object to check
   * @param {} ClassConstructor - Class constructor
   * @returns {Boolean}
   */
  isInstance(obj, ClassConstructor) {
    return obj instanceof ClassConstructor;
  }

  /**
   * @summary Add leading zeroes to a number(or string number).
   * @description Pads a number **OR** string with leading zeroes to reach a specified total length.
   * Returns a string with leading zeroes.
   * @example M.padZero(1.35,5) //returns: "001.35"
   * @param {number | string} val 
   * @param {number} length 
   * @returns {string} 
   */
  padZero(val, len){
    return val.toString().padStart(len, '0');
  };

  /**
   * @summary *Array Sort* - Sorts an array, defaults to ascending order.
   * @description Sorts an array of strings, numbers, or dates in ascending or descending order.
   * Defults to ascending order.
   * Automatically determines data type of array contents. **MUTATES** original array.
   * @param {Array} arr - Array of strings, numbers, or date strings/objects.
   * @param {boolean} [asc=true] - Sort ascending (true) or descending (false).
   * @returns {void} - Sorted array (mutates original array).
   */
  arrSort(arr = [], asc = true){
    return arr.sort((a, b) => {
      // Try to detect numbers
      if (
        this.isNumber(a) &amp;&amp; this.isNumber(b)
      ) {
        return asc ? Number(a) - Number(b) : Number(b) - Number(a);
      }
      // Try to detect dates
      if (this.isDate(a) &amp;&amp; this.isDate(b)) {
        return asc ? new Date(a) - new Date(b) : new Date(b) - new Date(a);
      }
      // Default: string comparison
      if (a &lt; b) return asc ? -1 : 1;
      if (a > b) return asc ? 1 : -1;
      return 0;
    });
  }

  /**
   * @summary *Array Reverse* - Sorts an array in descending order.
   * @description Sorts an array of strings, numbers, or dates in descending order. 
   * Automatically determines data type of array contents. **MUTATES** original array.
   * @param {Array} arr - Array of strings, numbers, or date strings/objects.
   * @returns {void} - Sorted array (mutates original array).
   */
  arrReverse(arr = []){
    return this.arrSort(arr, false);
  }

  /**
   * @summary *Array too Sorted* - Sorts an array, defaults to ascending order.
   * @description Sorts an array of strings, numbers, or dates in ascending or descending order.
   * Defults to ascending order. 
   * Automatically determines data type of array contents. Returns a **new** array.
   * @param {Array} arr - Array of strings, numbers, or date strings/objects.
   * @param {boolean} [asc=true] - Sort ascending (true) or descending (false).
   * @returns {Array} - Sorted array (new array, does not mutate original).
   */
   arr2Sorted(arr = [], asc = true){
    var newArr = arr.slice()
    return this.arrSort(newArr, asc);
  }

  /**
   * @summary *Array too Reversed* - Sorts an array in descending order.
   * @description Sorts an array of strings, numbers, or dates in descending order. 
   * Automatically determines data type of array contents. Returns a **new** array.
   * @param {Array} arr - Array of strings, numbers, or date strings/objects.
   * @returns {Array} - Sorted array (new array, does not mutate original).
   */
  arr2Reversed(arr = []){
    var newArr = arr.slice()
    return this.arrSort(newArr, false);
  }

  /**
   * @summary *Rows too Sorted* - Sorts an array of Objects, defaults to ascending order.
   * @description Sorts an array of objects by a given property,
   * or by value if objects contain only one key:value pair and parameter 'key' is null.
   * Automatically sorts as number if type is 'number' or values are numbers,
   * and as date if type is 'date' or values are valid dates. Returns a **new** array.
   * @param {Object[]} arr - Array of objects to sort.
   * @param {string|null} key - Property name to sort by, or null to sort by value if objects have only one key:value pair.
   * @param {boolean} [asc=true] - Sort ascending (true) or descending (false).
   * @param {'string'|'number'|'date'} [type='string'] - Type of property to sort by.
   * @returns {Object[]} - Sorted array (new array, does not mutate original).
   */
  rows2Sorted(arr, key = null, asc = true, type = 'string'){
    return arr.slice().sort((a, b) => {
      let valA, valB;
      if (key === null &amp;&amp; Object.keys(a).length === 1 &amp;&amp; Object.keys(b).length === 1) {
        valA = Object.values(a)[0];
        valB = Object.values(b)[0];
      } else {
        valA = a[key];
        valB = b[key];
      }

      // Auto-detect number
      if (
        type === 'number' ||
        (typeof valA === 'number' &amp;&amp; typeof valB === 'number') ||
        (!isNaN(Number(valA)) &amp;&amp; !isNaN(Number(valB)) &amp;&amp; valA !== '' &amp;&amp; valB !== '')
      ) {
        valA = Number(valA);
        valB = Number(valB);
        return asc ? valA - valB : valB - valA;
      }

      // Auto-detect date
      const isDateA = !isNaN(Date.parse(valA));
      const isDateB = !isNaN(Date.parse(valB));
      if (
        type === 'date' ||
        (isDateA &amp;&amp; isDateB)
      ) {
        valA = new Date(valA);
        valB = new Date(valB);
        return asc ? valA - valB : valB - valA;
      }

      // Default: string comparison
      if (valA &lt; valB) return asc ? -1 : 1;
      if (valA > valB) return asc ? 1 : -1;
      return 0;
    });
  }

  //No JSDOC, for use in arrRem and arr2Rem
  arrRem1(haystack, needle){
    haystack.splice(haystack.indexOf(needle), 1);
  }

  /**
   * @summary *Array Remove* - Remove element from array.
   * @description Remove element **OR** elements from array, needle can be a single element or an array of elements. 
   * ie: Remove data_name string from array of data_names. Return new list of field names.
   * **MUTATES** original array.
   * @param {Array} haystack - array to add element to
   * @param {any} needle - element to remove from array
   * @returns {void} - mutates original array
   */
  arrRem(haystack, needle){
    // function remove1(el) {
    //   haystack.splice(haystack.indexOf(el), 1);
    // }
    return Array.isArray(needle) ? needle.forEach((item) => this.arrRem1(haystack,item)) : this.arrRem1(haystack,needle);
  };

    /**
   * @summary *Array too Remove* - Return new array with elements removed.
   * @description Remove element **OR** elements from array, needle can be a single element or an array of elements. 
   * ie: Remove data_name string from array of data_names. Return new list of field names.
   * Returns a **new** array.
   * @param {Array} haystack - array to add element to
   * @param {any} needle - element to remove from array
   * @returns {Array} - returns new array with elements removed.
   */
  arr2Rem(haystack, needle){
    const arr = haystack.slice()
    return Array.isArray(needle) ? needle.forEach((item) => this.arrRem1(arr,item)) : this.arrRem1(arr,needle);
  }

  /**
   * @summary *Array Splice* - Add element to array, default to end of array.
   * @description Add element to array at position "pos". MUTATES the existing array.
   * ie: Add field name string to list of field names at position "pos". Return new list of field names.
   * 
   * MUTATES existing array.
   * @param {Array} haystack - array to add element to
   * @param {any} needle - element to add to array
   * @param {number} pos - position in array to add element
   * @returns {void}
   * @todo change to arrInsert
   */
  arrSplice(haystack, needle, pos){
    pos = pos ? pos : haystack.length;
    haystack.splice(pos, 0, needle);
  };

  /**
   * @summary *Date Add Days* - Adds days to a date.
   * @description Adds a number of days to a date and returns the new date.
   * Input can be a Date object or a date string.
   * @param {Date|string} dt - The starting date (Date object or date string).
   * @param {number} days - Number of days to add.
   * @returns {Date} - The new Date object.
   */
  dtAddDays(dt, days) {
    const d = new Date(dt);
    d.setDate(d.getDate() + days);
    return d;
  }

  /**
   * @summary *Date Month Bounds* - Get first and last day of month for a given date.
   * @description Returns the first and last day of the month for a given date.
   * @param {Date|string} dt - A Date object or date string.
   * @returns {{first: Date, last: Date}}
   */
  dtMonthBounds(dt) {
    const d = new Date(dt);
    const first = new Date(d.getFullYear(), d.getMonth(), 1);
    const last = new Date(d.getFullYear(), d.getMonth() + 1, 0);
    return { first, last };
  }

  /**
   * @summary *Date Days Difference* - Calculate the difference in days between two dates.
   * @description Calculate the difference in days between two dates.
   * @param {Date} dt1
   * @param {Date} dt2 
   * @returns {number}
   */
  dtDaysDiff(dt1 = new Date(), dt2 = new Date()) {
    return Math.round((dt2.getTime() - dt1.getTime()) / (1000 * 3600 * 24));
  };

  /**
   * @summary *ISO too Date* - Convert ISO to Date.
   * @description Convert ISO date in string format to javascript date/unix timestamp.
   * Strips time and timezone if present before conversion.
   * @param {string} str - ISO date in string format
   * @returns {Date}
   */
  iso2dt(str = '') {
    return new Date(this.dtStrip(str));
  };

  /**
   * @summary *Date Strip* - Strip timezone and time from ISO String date.
   * @description Strip timezone and time from ISO date and time in string format
   * 
   * ie: '2024-09-09T16:23:47Z' returns '2024-09-09'
   * @param {string} str - ISO date in string format
   * @returns {string}
   */
  dtStrip(str = '') {
    return str.split('T')[0];
  };

  /**
   * @summary *Date too ISO* - Convert Date to ISO string.
   * @description Convert javascript date/unix timestamp to ISO string with time and timezone stripped
   * strips time and timezone from ISO string.
   * @param {Date} dt - ISO date in string format
   * @returns {string}
   */
  dt2iso(dt = new Date()) {
    return dt.toISOString().split('T')[0];
  }

  /**
   * @summary *Array Any in Array* - Check if any string in one array is in another array.
   * @description Returns true if any string in arr1 matches any string in arr2.
   * @param {string[]} arr1
   * @param {string[]} arr2
   * @returns {boolean}
   */
  arrAnyInArr(arr1, arr2){
    return arr1.some(item1 => arr2.includes(item1));
  }

  /**
   * @summary *Array Count Items* - Count occurrences of items in an array.
   * @description Counts the number of occurrences of each unique item in an array and returns an array of objects,
   * each with properties 'item' and 'count', sorted by count descending.  
   * Example: *['a','b','a'] => [ { item: 'a', count: 2 }, { item: 'b', count: 1 } ]*
   * @param {Array.&lt;string|number>} arr - Array of primitive values to count.
   * @returns {Array.&lt;{item: (string|number), count: number}>} Array of {item, count} objects sorted by descending count. Returns empty array if input array is empty.
   */
  arrCountItems(arr = []){
    const countObj = arr.reduce((acc, el) => {
      acc[el] = (acc[el] || 0) + 1;
      return acc;
    }, {});
    const arrOfObj = Object.entries(countObj).map(([item, count]) => ({ item, count }));
    return this.rows2Sorted(arrOfObj, 'count', false, 'number');
  }

  /**
   * @summary *Array List Duplicates* - List duplicate values in an array.
   * @description Creates an array containing all values that are present in array more then once.
   * Also see arrUnique to filter an array down to only unique values.
   * @param {Array} arr
   * @returns {Array}
   */
  arrListDups(arr = []){
    if (!Array.isArray(arr) || arr.length === 0) return [];
    const counts = arr.reduce((acc, item) => {
      acc[item] = (acc[item] || 0) + 1;
      return acc;
    }, {});
    return Object.keys(counts).filter(item => counts[item] > 1);
  };

  /**
   * @summary *Array Unique* - Filter array to unique values.
   * @description Filter an array down to an array of unique values
   * @param {Array} arr 
   * @returns {Array}
   */
  arrUnique(arr){
    return arr.filter((x,i)=>arr.indexOf(x)===i)
  }
  
  /**
   * @summary *String After* - Return slice AFTER **FIRST** occurence.
   * @description Return slice of string AFTER **FIRST** occurence of search string.
   * Useful for getting **middle** section of text after underscore in data_name.
   * @param {string} val - string to search IN
   * @param {string} search - string to search FOR in val
   * @returns {string}
   */
  strAfter(val='',search='_'){
    const i = val.indexOf(search)
    return val.slice(i+search.length)
  }

  /**
   * @summary *String Suffix* - Return slice AFTER **LAST** occurence.
   * @description Return slice of string AFTER **LAST** occurence of search string.
   * Useful for getting suffix of text after last underscore in data_name.
   * @param {string} val - string to search IN
   * @param {string} search - string to search FOR in val
   * @returns {string}
   */
  strSuff(val='',search='_'){
    const i = val.lastIndexOf(search)
    return val.slice(i+search.length)
  }

  /**
   * @summary *String Before* - Return slice BEFORE **FIRST** occurence.
   * @description Return slice of string BEFORE **FIRST** occurence of search string.
   * Useful for getting prefix of text before first underscore in data_name.
   * @param {string} val - string to search IN
   * @param {string} search - string to search FOR in val
   * @returns {string}
   */
  strBefore(val='',search='_'){
    const i = val.indexOf(search)
    return val.slice(0,i)
  }

  /**
   * @summary Determines if a value is a number.
   * @description Determines if a value is a number (not NaN, not a string).
   * @param {any} val
   * @returns {boolean}
   */
  isNumber(val) {
    return typeof val === 'number' &amp;&amp; !isNaN(val);
  }

  /**
   * @summary Determines if a value is a valid Date object or a valid date string.
   * @description returns true if val is a Date object or a valid date string.
   * @param {any} val
   * @returns {boolean}
   */
  isDate(val) {
    // Check for Date object
    if (val instanceof Date) {
      return !isNaN(val.getTime());
    }
    // Check for valid date string
    if (typeof val === 'string') {
      const d = new Date(val);
      return !isNaN(d.getTime());
    }
    return false;
  }

  /**
   * @summary Check if variable is blank.
   * @description Check if variable is undefined, null or '' (empty string) OR if it is an Array if it has a length of 0 OR if it is an Object if it has an Object.keys() length of 0
   * @param {any} val
   * @returns {boolean}
   */
  isBlank(val) {
    return val === undefined || val === null
      ? true
      : typeof val === 'number' || typeof val === 'boolean'
        ? false
        : typeof val === 'string'
          ? val.trim() === ''
          : Array.isArray(val)
            ? val.length === 0
            : typeof val === 'object' &amp;&amp; val.constructor === Object
              ? Object.keys(val).length === 0
              : false;
  }
  // isBlank(val) {
  //   return Object.prototype.toString.call(val) == '[object Number]' ? false
  //     : Object.prototype.toString.call(val) == '[object Boolean]' ? false //not sure
  //       : !val ? true
  //         : val === '' ? true //not sure
  //           : typeof val === 'object' &amp;&amp; val.constructor === Object &amp;&amp; !Array.isArray(val) &amp;&amp; Object.keys(val).length === 0 ? true
  //             : Array.isArray(val) &amp;&amp; val.length === 0 ? true
  //               : false
  // };


  /**
   * @summary Check if string is in ISO 8601 date format.
   * @description Checks if string is in the format of an ISO 8601 date format
   * ie: '2011-10-05T14:48:00.000Z'
   * @param {string} str 
   * @returns {boolean}
   */
  isISOdt(str = '') {
    // //Limited Pattern:
    // var datePattern = /\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;
    // The pattern will be Â±[hh]:[mm], Â±[hh][mm], or Â±[hh], or 'Z'
    var dtPattern = new RegExp(/([+-]\d{2}|Z):?(\d{2})?\s*$/);
    if (!dtPattern.test(str)) return false;
    const d = new Date(str);
    return d instanceof Date &amp;&amp; !isNaN(d.getTime()) &amp;&amp; d.toISOString() === str; // valid date 
  };

  /**
   * @summary *Format Value* - Format unknown value to printable String.
   * @description Format unknown value to Merjent standard formatted String. 
   * Useful for values returned from Query API or REPEATABLEVALUES.
   * ie: a string '2011-10-05T14:48:00.000Z' returns '011-10-05"
   * ie: an array as a string 'apples,oranges,bananas" returns 'apples, oranges, bananas'
   * This function is intended for values that unknown values that are not returned from a fulcrum field. (for example from an HTTPS request).
   * For values from a fulcrum field use the fldVal method.
   * @param {any} val
   * @param {string} [naVal=null] - optional value for null, undifined and empty stings. DEFAULTS to '---'
   * @returns {string}
   * @todo fVal
   */
  fVal(val, naVal = null) {
    naVal = naVal || '---';
    if (this.isBlank(val)) return naVal;

    if (typeof val === 'object') {
      if (val instanceof Date) return this.dt2iso(val);
      if ('thoroughfare' in val) return this.formatAddress(val);
      if ('choice_values' in val) {
        let out = val.choice_values.join(', ');
        return val.other_values &amp;&amp; val.other_values.length > 0
          ? out + ', ' + val.other_values
          : out;
      }
    }

    if (Array.isArray(val)) return val.join(', ');
    if (typeof val === 'string' &amp;&amp; this.isISOdt(val)) return this.dtStrip(val);
    if (typeof val === 'number' || typeof val === 'boolean') return val.toString();

    return val;
  }

  // formatVal(val, naVal = null) {
  //   if (!this.isBlank(val)) {
  //     if (Object.prototype.toString.call(val) === '[object Object]') {
  //       if ('thoroughfare' in val) {
  //         return this.formatAddress(val);
  //       }
  //     }
  //     if (Object.prototype.toString.call(val) === '[object Object]') {
  //       if ('choice_values' in val) {
  //         var out = this.isBlank(val) ? naVal : val.choice_values.join(', ');
  //         return val.other_values &amp;&amp; val.other_values.length > 0  ? out + ', ' + val.other_values : out;
  //       }
  //     }
  //     if (Object.prototype.toString.call(val) === '[object Date]') {
  //       return this.dt2iso(val);
  //     }
  //     if (Array.isArray(val)) {
  //       return val.join(', ');
  //     }
  //     if (this.isISOdt(val)) {
  //       return this.dtStrip(val);
  //     }
  //     if (!Number.isNaN(val)) {
  //       return val;
  //     }
  //     else {
  //       return val;
  //     }
  //   }
  //   else if (this.isBlank(val)) {
  //     return naVal;
  //   }
  //   else {
  //     return 'ERROR in formatVal function: Unknown error';
  //   }
  // };

  /**
   * @summary *Format Address*
   * @description Formats a fulcrum address object into a us address formated string.
   * @param {Object} val
   * @returns {string}
   * @todo fAddress
   */
  formatAddress(val = {}) {
    var sub = '';
    var street = '';
    var city = '';
    var county = '';
    var state = '';
    var post = '';
    var suite = '';

    if (val) {
      sub = val.sub_thoroughfare || '';
      street = val.thoroughfare || '';
      city = val.locality ? val.locality + ', ' : '';
      county = val.sub_admin_area ? val.sub_admin_area + ', ' : '';
      state = val.admin_area || '';
      post = val.postal_code || '';
      suite = val.suite || '';
      return `${sub} ${street} ${suite} ${city} ${county} ${state} ${post}`;
    }
    return '';
  };

  /**
   * @summary *Flip Key:Value Pair* - Flips keys and values in an object.
   * @description Flips keys and values in an object. Object must have unique values.
   * Input is an Object **NOT** an array of objects.
   * @param {*} obj 
   * @returns {*} 
   */
  flipKVpair(obj){
    return Object.fromEntries(Object.entries(obj).map(([k,v])=>[v,k]))
  };

  /**
   * @summary *Clean HTML* - Removes newlines and trims whitespace from template literal.
   * @description Useful for embedding HTML snippets in JavaScript without extra whitespace or newlines.
   * removes all newline characters (\r and \n).
   * removes any leading or trailing whitespace.
   * @param {string} strings 
   * @param {...{}} vals 
   * @returns {*} 
   * @todo better name? cleanTemplateLiteral?
   */
  html(strings, ...vals){
    let result = strings.reduce((acc, str, i) => acc + (vals[i - 1] || '') + str);
    return result.replace(/[\r\n]+/gm, '').trim();
  };
  

  /**
   * @summary *String Proper* - Capitalizes the first character of a word
   * @description Capitalizes the first character of a word and converts the rest to lowercase.
   * @param {string} word - The word to capitalize.
   * @returns {string} - The capitalized word.
   */
  strProper(word) {
    return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
  }

  /**
   * @summary *data_name too Title* - Converts a string with underscores to title case.
   * @description Converts a string to title case by replacing '_' with a ' ' and applying capitalization to each word.
   * Use to convert Fulcrum data_name strings to title case.
   * @param {string} str - The input string.
   * @returns {string} - The string converted to title case.
   */
  dn2Title(str) {
    var spaced = str.replace(/_/g,' ')
    return spaced.replace(/\w\S*/g, this.strProper);
  }

  /**
   * @summary *Rows Find* - Find objects in array by property value.
   * @description Finds objects with property matching lookup value in an array of objects and returns that object.
   * @param {Object[]} rows - The array of objects to search.
   * @param {string} key - The property to look up in the objects.
   * @param {string} val - The value to match against the property.
   * @returns {Object[]}
   */
  rowsFind(rows, key, val) {
    const output = [];
    for (const row of rows) {
      if (row[key] === val) {
        output.push(row);
      }
    }
    return output.length > 0 ? output : null;
  }

  /**
   * @summary *Decimal Degrees too DMS*
   * @description Converts decimal degrees to Degrees, Minutes, Seconds (DMS) format.
   *
   * @param {number} dd - The decimal degrees value (e.g., 40.6892). Positive for N/E, negative for S/W.
   * @param {boolean} isLat - true for latitude, false for longitude.
   * @returns {array} [degrees,minutes,seconds,direction,The DMS string (e.g., "40Â° 41' 21.12" N")]
   */
  dd2dms(dd, isLat) {
    const absDeg = Math.abs(dd);
    const deg = Math.floor(absDeg);
    const minD = (absDeg - deg) * 60;
    const min = Math.floor(minD);
    const sec = (minD - min) * 60;
    let dir = ''; // direction (N/S for latitude, E/W for longitude)

    // if (dd > 0) {
    //     // Assume latitude if only one number is provided
    //     dir = 'N/E';
    // } else if (dd &lt; 0) {
    //     dir = 'S/W';
    // } else {
    //     dir = ''; // For 0 deg
    // }

    if (isLat) {
      dir = dd >= 0 ? 'N' : 'S';
    } else { // Must be Longitude
      dir = dd >= 0 ? 'E' : 'W';
    }

    const fSec = sec.toFixed(2);

    return [deg,min,fSec,dir,`${deg}Â° ${min}' ${fSec}" ${dir}`];
  }

  /**
   * @summary *DMS to Decimal Degrees*
   * @description Converts Degrees, Minutes, Seconds (DMS) to Decimal Degrees. 
   * Input direction is optional and defaults to 'N' or 'E' (ie: positive number in DD).
   *
   * @param {number} deg The degrees part (e.g., 40).
   * @param {number} min The minutes part (e.g., 41).
   * @param {number} sec The seconds part (e.g., 21.12).
   * @param {string} [dir='N/E'] The directional quadrant (N, S, E, or W).
   * @returns {number} The decimal degrees value (e.g., 40.6892).
   */
  dms2dd(deg, min, sec, dir = 'N') {
    let result = deg + (min / 60) + (sec / 3600);
    const upperDirection = dir.toUpperCase();
    if (upperDirection === 'S' || upperDirection === 'W') {
      result = -result;
    }

    return result;
  }
}
//#endregion 

export { Helpers };</code></pre>
		</section>
			</div>
		</div>
	</div>
	<footer>
				<div class="copyright">Mtools Copyright Â© 2025 Mikel Paiva</div>
			<div class="generated-by">Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on 27th Oct 2025 using the <a href="https://github.com/steveush/foodoc">FooDoc template</a>.</div>
	</footer>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/clipboard.min.js"></script>
	<script src="js/prism.min.js"></script>
	<script src="js/template.min.js"></script>
		<!-- start:lunr-search-modal.hbs -->
		<div class="modal fade" id="lunr-search-modal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title">Search results</h4>
					</div>
					<div class="modal-body" id="lunr-search-body">
					</div>
					<div class="modal-footer" id="lunr-search-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div>
		<!-- end:lunr-search-modal.hbs -->		<script src="js/lunr.min.js"></script>
	
</body>
</html>
<!-- end:source.tmpl.hbs -->